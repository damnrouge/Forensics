

+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Objective**             | **Command**                                              | **Location/Notes**                                    |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **File Timestamps**       | stat /path/to/hidden/folder/malicious_file               | -                                                    |
|                           | ls -ltu /path/to/hidden/folder/malicious_file            | Access time                                          |
|                           | ls -lt /path/to/hidden/folder/malicious_file             | Modification time                                    |
|                           | ls -ltc /path/to/hidden/folder/malicious_file            | Change time                                          |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **File Owner**            | ls -l /path/to/hidden/folder/malicious_file              | -                                                    |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **User Shell History**    | cat /home/username/.bash_history                         | For each user                                        |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Login Records**         | last -F                                                  | -                                                    |
|                           | who                                                      | Current logged in users                              |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Running Processes**     | ps aux | grep suspicious_process                         | -                                                    |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Open Files**            | lsof | grep /path/to/hidden/folder/malicious_file        | List of open files                                   |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **System Logs**           | grep -i "malicious_file" /var/log/syslog                 | Check system logs for activity                       |
|                           | grep -i "malicious_file" /var/log/auth.log               | Check authentication logs                            |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Network Connections**   | netstat -tulnp | grep malicious_file                     | -                                                    |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Cron Jobs**             | crontab -l                                               | Current userâ€™s cron jobs                             |
|                           | cat /etc/crontab                                         | System-wide cron jobs                                |
|                           | ls /etc/cron.* /var/spool/cron/crontabs                  | Other cron job directories                           |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Loaded Kernel Modules** | lsmod                                                    | List of loaded kernel modules                        |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Open Ports**            | netstat -tuln                                            | Check for unusual open ports                         |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Scheduled Tasks**       | systemctl list-timers                                    | List systemd timers                                  |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Startup Scripts**       | ls /etc/init.d/                                          | Check init.d scripts                                 |
|                           | ls /etc/systemd/system/                                  | Check systemd service files                          |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Installed Packages**    | dpkg -l or rpm -qa                                       | List all installed packages (Debian or RedHat based) |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Environment Variables** | printenv                                                 | Check environment variables                          |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Modified Config Files** | find /etc -type f -mtime -7                              | Find config files modified in the last 7 days        |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **Disk Usage**            | du -sh /path/to/hidden/folder                            | Check disk usage of the folder                       |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **File Integrity Check**  | debsums (Debian) or rpm -Va (RedHat)                     | Verify integrity of installed packages               |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+
| **File Hashing (MD5)**    | md5sum /path/to/hidden/folder/malicious_file             | Get MD5 hash of the file                             |
+---------------------------+----------------------------------------------------------+------------------------------------------------------+


+---------------------------+----------------------------------------------------------+
| **Location**              | **Description**                                          |
+---------------------------+----------------------------------------------------------+
| /path/to/hidden/folder/   | File Information                                         |
| malicious_file            |                                                          |
+---------------------------+----------------------------------------------------------+
| /home/username/.bash_     | User History                                             |
| history                   |                                                          |
+---------------------------+----------------------------------------------------------+
| /var/log/auth.log         | Login Records                                            |
+---------------------------+----------------------------------------------------------+
| /var/log/lastlog          |                                                          |
+---------------------------+----------------------------------------------------------+
| /var/log/syslog           | System Logs                                              |
+---------------------------+----------------------------------------------------------+
| /var/log/auth.log         |                                                          |
+---------------------------+----------------------------------------------------------+
| /etc/crontab              | Cron Jobs                                                |
+---------------------------+----------------------------------------------------------+
| /var/spool/cron/crontabs  |                                                          |
+---------------------------+----------------------------------------------------------+
| lsmod                     | Kernel Modules                                           |
+---------------------------+----------------------------------------------------------+
| netstat -tuln             | Open Ports                                               |
+---------------------------+----------------------------------------------------------+
| systemctl list-timers     | Scheduled Tasks                                          |
+---------------------------+----------------------------------------------------------+
| /etc/init.d/              | Startup Scripts                                          |
+---------------------------+----------------------------------------------------------+
| /etc/systemd/system/      |                                                          |
+---------------------------+----------------------------------------------------------+
| dpkg -l or rpm -qa        | Installed Packages                                       |
+---------------------------+----------------------------------------------------------+
| printenv                  | Environment Variables                                    |
+---------------------------+----------------------------------------------------------+
| /etc/                     | Configuration Files                                      |
+---------------------------+----------------------------------------------------------+
| du -sh /path/to/hidden/   | Disk Usage                                               |
| folder                    |                                                          |
+---------------------------+----------------------------------------------------------+
| debsums (Debian) or       | File Integrity                                           |
| rpm -Va (RedHat)          |                                                          |
+---------------------------+----------------------------------------------------------+
| md5sum /path/to/hidden/   | File Hashing (MD5)                                       |
| folder/malicious_file     |                                                          |
+---------------------------+----------------------------------------------------------+


User centric:
+----------------------------+--------------------------------------------------+
| **Objective**              | **Command**                                      |
+----------------------------+--------------------------------------------------+
| **List of logged-in users**| who                                              |
+----------------------------+--------------------------------------------------+
| **User login history**     | last -F                                          |
+----------------------------+--------------------------------------------------+
| **User's shell history**   | cat /home/username/.bash_history                 |
+----------------------------+--------------------------------------------------+
| **Check sudo usage**       | grep 'sudo' /var/log/auth.log                    |
+----------------------------+--------------------------------------------------+
| **Failed login attempts**  | grep 'Failed password' /var/log/auth.log         |
+----------------------------+--------------------------------------------------+
| **Recent user activity**   | aureport -au                                     |
+----------------------------+--------------------------------------------------+
| **Processes run by user**  | ps -U username                                   |
+----------------------------+--------------------------------------------------+
| **Open files by user**     | lsof -u username                                 |
+----------------------------+--------------------------------------------------+
| **User's cron jobs**       | crontab -u username -l                           |
+----------------------------+--------------------------------------------------+
| **SSH login attempts**     | grep 'sshd' /var/log/auth.log                    |
+----------------------------+--------------------------------------------------+
| **Modifications by user**  | find / -user username -mtime -7                  |
+----------------------------+--------------------------------------------------+
| **User's network activity**| netstat -tulnp | grep username                   |
+----------------------------+--------------------------------------------------+
| **User's environment vars**| su - username -c 'printenv'                      |
+----------------------------+--------------------------------------------------+
| **Check for root kits**    | chkrootkit                                       |
+----------------------------+--------------------------------------------------+
| **Verify binaries**        | debsums -s (Debian) or rpm -Va (RedHat)          |
+----------------------------+--------------------------------------------------+
| **System-wide cron jobs**  | cat /etc/crontab                                 |
+----------------------------+--------------------------------------------------+
| **Check .ssh directory**   | ls -la /home/username/.ssh                       |
+----------------------------+--------------------------------------------------+


File centric:
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Objective**                        | **Command**                                                | **Description/Location**                    |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **File Timestamps**                  | stat /path/to/file                                         | Retrieve access, modification, change times |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **File Owner and Permissions**       | ls -l /path/to/file                                        | Check file ownership and permissions        |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **File Hashing (MD5)**               | md5sum /path/to/file                                       | Generate MD5 hash for file integrity check  |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Open Files**                       | lsof | grep /path/to/file                                  | List processes using the file               |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Recent Modifications**             | find / -type f -mtime -7                                   | Find files modified in the last 7 days      |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Running Processes**                | ps aux | grep suspicious_process                            | Identify processes related to the file      |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **System Logs**                      | grep -i "filename" /var/log/syslog                         | Check syslog for file activity              |
|                                      | grep -i "filename" /var/log/auth.log                       | Check auth log for file activity            |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Network Activity**                 | netstat -tulnp | grep filename                               | Check network connections related to file   |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Hidden Files**                     | find / -type f -name ".*"                                  | Identify hidden files                       |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------|
| **File Integrity**                   | debsums (Debian-based) or rpm -Va (RedHat-based)           | Verify installed package files integrity    |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Malware Signatures**               | clamscan /path/to/file                                     | Scan file for malware signatures            |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Cron Jobs**                        | crontab -l                                                 | List user cron jobs                         |
|                                      | cat /etc/crontab                                           | Check system-wide cron jobs                 |
|                                      | ls /etc/cron.* /var/spool/cron/crontabs                    | Check other cron job directories            |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **File Access**                      | ausearch -f /path/to/file                                  | Search audit logs for file access           |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Recent User Activity**             | aureport -au                                               | Summarize user activity                     |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **User's SSH Attempts**              | grep 'sshd' /var/log/auth.log                              | Check SSH login attempts                    |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Processes Run by User**            | ps -U username                                             | List processes run by specific user         |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Open Files by User**               | lsof -u username                                           | List open files by specific user            |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **User's Network Activity**          | netstat -tulnp | grep username                             | Check user's network connections            |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Environment Variables**            | su - username -c 'printenv'                                | Check user's environment variables          |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Check .ssh Directory**             | ls -la /home/username/.ssh                                 | List contents of user's .ssh directory      |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+
| **Verify System Binaries**           | debsums -s (Debian) or rpm -Va (RedHat)                    | Verify integrity of system binaries         |
+--------------------------------------+------------------------------------------------------------+---------------------------------------------+

Malicious IP Or URL:
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Objective**                  | **Command**                                              | **Description/Location**                  |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Network Logs**               | grep 'malicious_ip' /var/log/firewall.log                | Check firewall logs                       |
|                                | grep 'malicious_url' /var/log/squid/access.log           | Check proxy logs                          |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Active Network Connections** | netstat -tulnp | grep 'malicious_ip'                     | List active connections                   |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Historical Connections**     | ausearch -i | grep 'malicious_ip'                      | Search audit logs for connections         |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **System Logs**                | grep 'malicious_ip' /var/log/syslog                      | Check system logs                         |
|                                | grep 'malicious_ip' /var/log/auth.log                    | Check authentication logs                 |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Running Processes**          | lsof -i | grep 'malicious_ip'                         | List processes using the IP               |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **User Shell History**         | cat /home/username/.bash_history | grep 'malicious_url'  | Check user shell history                 |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Malicious File Presence**    | find / -type f -exec grep -l 'malicious_url' {} +        | Find downloaded files                     |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Hidden Files**               | find / -type f -name ".*"                                | Identify hidden files                     |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Cron Jobs**                  | crontab -l -u username                                   | List user cron jobs                       |
|                                | cat /etc/crontab                                         | Check system-wide cron jobs               |
|                                | ls /etc/cron.* /var/spool/cron/crontabs                  | Check other cron job directories          |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Web Server Logs**            | grep 'malicious_url' /var/log/apache2/access.log         | Check Apache logs                         |
|                                | grep 'malicious_url' /var/log/nginx/access.log           | Check Nginx logs                          |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **DNS Queries**                | grep 'malicious_url' /var/log/named/named.log            | Check DNS logs                            |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **System Configuration**       | cat /etc/hosts | grep 'malicious_ip'                     | Check `/etc/hosts` for entries            |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **File Integrity**             | debsums -s (Debian) or rpm -Va (RedHat)                  | Verify system binaries                    |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Rootkit Detection**          | chkrootkit                                               | Check for rootkits                        |
|                                | rkhunter --check                                         |                                           |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Network Traffic Capture**    | tcpdump -i eth0 host malicious_ip -w suspicious.pcap     | Capture network traffic                   |
|                                | wireshark suspicious.pcap                                | Analyze captured traffic                  |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **SSH Logs**                   | grep 'sshd' /var/log/auth.log                            | Check SSH login attempts                  |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **FTP Logs**                   | grep 'malicious_ip' /var/log/vsftpd.log                  | Check FTP logs (vsftpd)                   |
|                                | grep 'malicious_ip' /var/log/proftpd/proftpd.log         | Check FTP logs (proftpd)                  |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Mail Server Logs**           | grep 'malicious_ip' /var/log/mail.log                    | Check mail server logs                    |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Installed Packages**         | dpkg -l | grep 'malicious_package' (Debian-based)       | Check for suspicious installed packages   |
|                                | rpm -qa | grep 'malicious_package' (RedHat-based)       |                                           |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Environment Variables**      | printenv | grep 'malicious_env'                          | Check for malicious environment variables |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Loaded Kernel Modules**      | lsmod | grep 'malicious_module'                        | Check for suspicious kernel modules       |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Configuration Files**        | find /etc -type f -exec grep -l 'malicious_config' {} +  | Find modified configuration files         |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
| **Disk Usage**                 | du -sh /path/to/hidden/folder                            | Check disk usage of the folder            |
+--------------------------------+----------------------------------------------------------+-------------------------------------------+
