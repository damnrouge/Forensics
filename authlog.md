Jun  1 12:01:01 server01 CRON[12843]: pam_unix(cron:session): session opened for user root by (uid=0)
Jun  1 12:01:01 server01 CRON[12843]: pam_unix(cron:session): session closed for user root
Jun  1 12:05:01 server01 sshd[12850]: Failed password for invalid user test from 192.168.1.100 port 40022 ssh2
Jun  1 12:05:01 server01 sshd[12851]: Failed password for invalid user admin from 192.168.1.100 port 40023 ssh2
Jun  1 12:06:21 server01 sshd[12855]: Failed password for invalid user user from 192.168.1.100 port 40024 ssh2
Jun  1 12:07:31 server01 sshd[12860]: Failed password for invalid user guest from 192.168.1.100 port 40025 ssh2
Jun  1 12:08:45 server01 sshd[12862]: Failed password for invalid user root from 192.168.1.100 port 40026 ssh2
Jun  1 12:10:01 server01 sshd[12865]: Failed password for invalid user admin from 192.168.1.100 port 40027 ssh2
Jun  1 12:12:21 server01 sshd[12870]: Failed password for invalid user test from 192.168.1.100 port 40028 ssh2
Jun  1 12:13:01 server01 CRON[12875]: pam_unix(cron:session): session opened for user www-data by (uid=33)
Jun  1 12:13:01 server01 CRON[12875]: pam_unix(cron:session): session closed for user www-data
Jun  1 12:14:33 server01 sshd[12880]: Failed password for invalid user user from 192.168.1.100 port 40029 ssh2
Jun  1 12:15:42 server01 sshd[12885]: Failed password for invalid user root from 192.168.1.100 port 40030 ssh2
Jun  1 12:16:54 server01 sshd[12890]: Failed password for invalid user admin from 192.168.1.100 port 40031 ssh2
Jun  1 12:17:01 server01 sshd[12895]: Failed password for invalid user guest from 192.168.1.100 port 40032 ssh2
Jun  1 12:18:01 server01 sshd[12900]: Failed password for invalid user user from 192.168.1.100 port 40033 ssh2
Jun  1 12:19:01 server01 CRON[12910]: pam_unix(cron:session): session opened for user backup by (uid=1001)
Jun  1 12:19:01 server01 CRON[12910]: pam_unix(cron:session): session closed for user backup
Jun  1 12:20:21 server01 sshd[12920]: Failed password for invalid user test from 192.168.1.100 port 40034 ssh2
Jun  1 12:22:33 server01 sshd[12930]: Failed password for invalid user guest from 192.168.1.100 port 40035 ssh2
Jun  1 12:23:01 server01 sshd[12940]: Failed password for invalid user user from 192.168.1.100 port 40036 ssh2
Jun  1 12:24:01 server01 CRON[12950]: pam_unix(cron:session): session opened for user root by (uid=0)
Jun  1 12:24:01 server01 CRON[12950]: pam_unix(cron:session): session closed for user root
Jun  1 12:25:42 server01 sshd[12960]: Failed password for invalid user root from 192.168.1.100 port 40037 ssh2
Jun  1 12:27:01 server01 sshd[12970]: Failed password for invalid user admin from 192.168.1.100 port 40038 ssh2
Jun  1 12:28:21 server01 sshd[12980]: Failed password for invalid user test from 192.168.1.100 port 40039 ssh2
Jun  1 12:29:45 server01 sshd[12990]: Failed password for invalid user guest from 192.168.1.100 port 40040 ssh2
Jun  1 12:30:01 server01 sshd[13000]: Failed password for invalid user user from 192.168.1.100 port 40041 ssh2
Jun  1 12:32:01 server01 sshd[13010]: Failed password for invalid user root from 192.168.1.100 port 40042 ssh2
Jun  1 12:34:15 server01 sshd[13020]: Failed password for invalid user admin from 192.168.1.100 port 40043 ssh2
Jun  1 12:36:21 server01 sshd[13030]: Failed password for invalid user test from 192.168.1.100 port 40044 ssh2
Jun  1 12:37:42 server01 sshd[13040]: Failed password for invalid user guest from 192.168.1.100 port 40045 ssh2
Jun  1 12:39:01 server01 sshd[13050]: Failed password for invalid user user from 192.168.1.100 port 40046 ssh2
Jun  1 12:41:21 server01 sshd[13060]: Failed password for invalid user root from 192.168.1.100 port 40047 ssh2
Jun  1 12:42:45 server01 sshd[13070]: Failed password for invalid user admin from 192.168.1.100 port 40048 ssh2
Jun  1 12:44:01 server01 CRON[13080]: pam_unix(cron:session): session opened for user root by (uid=0)
Jun  1 12:44:01 server01 CRON[13080]: pam_unix(cron:session): session closed for user root
Jun  1 12:45:33 server01 sshd[13090]: Failed password for invalid user test from 192.168.1.100 port 40049 ssh2
Jun  1 12:46:54 server01 sshd[13100]: Failed password for invalid user guest from 192.168.1.100 port 40050 ssh2
Jun  1 12:48:01 server01 sshd[13110]: Failed password for invalid user user from 192.168.1.100 port 40051 ssh2
Jun  1 12:50:21 server01 sshd[13120]: Failed password for invalid user root from 192.168.1.100 port 40052 ssh2
Jun  1 12:51:45 server01 sshd[13130]: Failed password for invalid user admin from 192.168.1.100 port 40053 ssh2
Jun  1 12:53:01 server01 sshd[13140]: Failed password for invalid user test from 192.168.1.100 port 40054 ssh2
Jun  1 12:54:21 server01 sshd[13150]: Failed password for invalid user guest from 192.168.1.100 port 40055 ssh2
Jun  1 12:55:33 server01 sshd[13160]: Failed password for invalid user user from 192.168.1.100 port 40056 ssh2
Jun  1 12:57:01 server01 sshd[13170]: Failed password for invalid user root from 192.168.1.100 port 40057 ssh2
Jun  1 12:58:21 server01 sshd[13180]: Failed password for invalid user admin from 192.168.1.100 port 40058 ssh2
Jun  1 13:00:01 server01 sshd[13190]: Failed password for invalid user test from 192.168.1.100 port 40059 ssh2
Jun  1 13:01:21 server01 sshd[13200]: Failed password for invalid user guest from 192.168.1.100 port 40060 ssh2
Jun  1 13:02:45 server01 sshd[13210]: Failed password for invalid user user from 192.168.1.100 port 40061 ssh2
Jun  1 13:03:01 server01 CRON[13220]: pam_unix(cron:session): session opened for user root by (uid=0)
Jun  1 13:03:01 server01 CRON[13220]: pam_unix(cron:session): session closed for user root


# Understanding `auth.log`

## Auth Log Format
```plaintext
<timestamp> <hostname> <service_name>[<process_id>]: <message>

The `auth.log` file in Linux systems logs all authentication-related events, such as user logins, failed login attempts, and other relevant security events. Each entry in the `auth.log` file consists of several fields providing details about the event.

## Breakdown of Fields

1. **Timestamp**: Indicates the date and time when the event occurred.
2. **Hostname**: The name of the host (server) where the event took place.
3. **Service**: The name of the service or daemon generating the log entry (e.g., `sshd`, `CRON`).
4. **Process ID**: The unique identifier for the process generating the log entry.
5. **Message**: A detailed message describing the event, including user information and the nature of the event.

## Example Entries and Their Meanings

### Failed Login Attempt
Jun 1 12:05:01 server01 sshd[12850]: Failed password for invalid user test from 192.168.1.100 port 40022 ssh2


- **Timestamp**: Jun  1 12:05:01
- **Hostname**: server01
- **Service**: sshd
- **Process ID**: 12850
- **Message**: Failed password for invalid user test from 192.168.1.100 port 40022 ssh2

This entry indicates a failed login attempt using the username `test` from the IP address `192.168.1.100`.

### Successful Login
Jun 1 13:05:01 server01 sshd[13230]: Accepted password for user from 192.168.1.100 port 40065 ssh2

- **Timestamp**: Jun  1 13:05:01
- **Hostname**: server01
- **Service**: sshd
- **Process ID**: 13230
- **Message**: Accepted password for user from 192.168.1.100 port 40065 ssh2

This entry indicates a successful login for the user `user` from the IP address `192.168.1.100`.

### CRON Job Execution
Jun 1 12:01:01 server01 CRON[12843]: pam_unix(cron
): session opened for user root by (uid=0)
Jun 1 12:01:01 server01 CRON[12843]: pam_unix(cron
): session closed for user root


- **Timestamp**: Jun  1 12:01:01
- **Hostname**: server01
- **Service**: CRON
- **Process ID**: 12843
- **Message**: 
  - `pam_unix(cron:session): session opened for user root by (uid=0)`: Indicates that a CRON job session for the user `root` has started.
  - `pam_unix(cron:session): session closed for user root`: Indicates that the CRON job session for the user `root` has ended.

## Key Points to Note

- **Failed Login Attempts**: Frequent failed login attempts, especially from the same IP address, can indicate a brute force attack.
- **Successful Logins**: Regular monitoring of successful logins helps ensure that only authorized users are accessing the system.
- **CRON Jobs**: Regular CRON job entries indicate scheduled tasks running as expected. Unusual CRON jobs might signify unauthorized or malicious activities.

## Additional Resources

- [Linux `auth.log` Documentation](https://linux.die.net/man/3/syslog)
- [Understanding SSH Logs](https://www.ssh.com/academy/ssh/logging)
- [CRON Job Basics](https://www.geeksforgeeks.org/cron-command-in-linux-with-examples/)
- [Linux Security and Monitoring](https://www.tecmint.com/linux-server-security-tips/)


## Filtering Specific Entries
# Filter for failed login attempts
grep "Failed password" /var/log/auth.log

# Filter for successful login attempts
grep "Accepted password" /var/log/auth.log

# Filter for CRON job executions
grep CRON /var/log/auth.log

## Counting Specific Events

# Count the number of failed login attempts
grep -c "Failed password" /var/log/auth.log

# Count the number of successful login attempts
grep -c "Accepted password" /var/log/auth.log

# Count the number of CRON job executions
grep -c CRON /var/log/auth.log


## Analyzing Failed Login Attempts

# Extract and sort IP addresses of failed login attempts
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -nr

# Extract and sort usernames used in failed login attempts
grep "Failed password" /var/log/auth.log | awk '{print $(NF-5)}' | sort | uniq -c | sort -nr

## Example Commands and Their Outputs

# Example: Viewing the last 20 lines of auth.log
tail -n 20 /var/log/auth.log

# Example: Filtering for failed login attempts and displaying the last 10
grep "Failed password" /var/log/auth.log | tail -n 10

# Example: Counting the number of successful login attempts
grep -c "Accepted password" /var/log/auth.log

# Example: Extracting and sorting IP addresses of failed login attempts
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -nr





